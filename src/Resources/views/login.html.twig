<!DOCTYPE html>
<html data-app-config='{{ getAppConfig() }}'>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<title>Authentification - {{ getEnv('APP_NAME') }} | BACK-OFFICE</title>
	<meta name="description" content="{{ getEnv('APP_NAME') }} | BACK-OFFICE">
	<meta name="keywords" content="{{ getEnv('APP_NAME') }}">
	<meta name="author" content="">
	<meta name="url" content="{{ getCurrentUrl() }}">
	<link rel="canonical" href="{{ getCurrentUrl() }}" />
	<link rel="icon" type="image/png" sizes="16x16" href="">
	<meta property="og:url" content="{{ getCurrentUrl() }}" />
	<meta property="og:type" content="website" />
	<meta property="og:title" content="{{ getEnv('APP_NAME') }} | BACK-OFFICE" />
	<meta property="og:description" content="{{ getEnv('APP_NAME') }} | BACK-OFFICE" />
	<meta property="og:image" content="" />

	{{ getHeadAssets() }}

	<link href="{{ getCDN('swagg/plugins/backoffice/fonts/Kodchasan/style.css?family=Kodchasan:600&display=swap') }}" rel="stylesheet">
	<link href="{{ getCDN('swagg/plugins/backoffice/fonts/Dosis/style.css?family=Dosis&display=swap') }}" rel="stylesheet">
    
	<style type="text/css">*{box-sizing:border-box;margin:0;padding:0;font-weight:300}body{font-family:"Dosis",sans-serif;color:#fff;font-weight:300}body ::-webkit-input-placeholder{font-family:"Dosis",sans-serif;color:#fff;font-weight:300}body :-moz-placeholder{font-family:"Dosis",sans-serif;color:#fff;opacity:1;font-weight:300}body ::-moz-placeholder{font-family:"Dosis",sans-serif;color:#fff;opacity:1;font-weight:300}body :-ms-input-placeholder{font-family:"Dosis",sans-serif;color:#fff;font-weight:300}.wrapper{background:#50a3a2;background:-webkit-linear-gradient(top left,#50a3a2 0,#53e3a6 100%);background:-moz-linear-gradient(top left,#50a3a2 0,#53e3a6 100%);background:-o-linear-gradient(top left,#50a3a2 0,#53e3a6 100%);background:linear-gradient(to bottom right,#50a3a2 0,#53e3a6 100%);position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden}.wrapper.form-success .container h1{transform:translateY(85px)}.container{max-width:600px;margin:0 auto;padding:80px 0;text-align:center;position:absolute;top:50%;transform:translateY(-50%);left:0;right:0;z-index:2;}.container h1{color:#000;font-size:30px;transition-duration:1s;transition-timing-function:ease-in-out;font-weight:200;margin-top:10px}form{position:relative;z-index:2}form input{appearance:none;outline:0;border:1px solid rgba(255,255,255,.4);background-color:rgba(255,255,255,.2);width:250px;border-radius:3px;padding:10px 15px;margin:0 auto 10px auto;display:block;text-align:center;font-size:18px;color:#fff;transition-duration:.25s;font-weight:300}form input:hover{background-color:rgba(255,255,255,.4)}form input:focus{background-color:#fff;color:#53e3a6}form button{appearance:none;outline:0;background-color:#fff;border:0;padding:10px 15px;color:#53e3a6;border-radius:3px;width:250px;cursor:pointer;font-size:18px;transition-duration:.25s}form button:hover{background-color:#f5f7f9}.bg-bubbles{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.bg-bubbles li{position:absolute;list-style:none;display:block;width:40px;height:40px;background-color:rgba(255,255,255,.15);bottom:-160px;-webkit-animation:square 25s infinite;animation:square 25s infinite;-webkit-transition-timing-function:linear;transition-timing-function:linear}.bg-bubbles li:nth-child(1){left:10%}.bg-bubbles li:nth-child(2){left:20%;width:80px;height:80px;animation-delay:2s;animation-duration:17s}.bg-bubbles li:nth-child(3){left:25%;animation-delay:4s}.bg-bubbles li:nth-child(4){left:40%;width:60px;height:60px;animation-duration:22s;background-color:rgba(255,255,255,.25)}.bg-bubbles li:nth-child(5){left:70%}.bg-bubbles li:nth-child(6){left:80%;width:120px;height:120px;animation-delay:3s;background-color:rgba(255,255,255,.2)}.bg-bubbles li:nth-child(7){left:32%;width:160px;height:160px;animation-delay:7s}.bg-bubbles li:nth-child(8){left:55%;width:20px;height:20px;animation-delay:15s;animation-duration:40s}.bg-bubbles li:nth-child(9){left:25%;width:10px;height:10px;animation-delay:2s;animation-duration:40s;background-color:rgba(255,255,255,.3)}.bg-bubbles li:nth-child(10){left:90%;width:160px;height:160px;animation-delay:11s}@-webkit-keyframes square{0%{transform:translateY(0)}100%{transform:translateY(-700px) rotate(600deg)}}@keyframes square{0%{transform:translateY(0)}100%{transform:translateY(-700px) rotate(600deg)}}
		.text-uppercase{text-transform:uppercase;}
		.swagg-logo-wrapper{margin: 10px 0}
		._alert {padding: 10px 0;margin: 25px 5px;font-size: 17px;background-color: #fff}
		._alert-error {color: #c32222;border-left: 5px solid #c32222;}
		._alert-success {color: #4CAF50;border-left: 5px solid #4CAF50;}
		.trademark { color: #000; margin-top: 30px; }
		form input {color: #52cea4;}
		form input::placeholder {color: #52cea4;}
		form {padding: 20px; background-color: rgba(255, 255, 255, 0.67); margin: auto; border-radius: 16px; max-width: 300px;}
		.appname-logo-wrapper{ margin: 15px 0; }
		.appname-logo-wrapper img { max-width: 145px; _border: 1px solid #ffffff; border-radius: 5px; padding: 2px; }
	</style>
</head>
<body>
	<div id="site_content">

		<main>
			<div class="wrapper">
				<div class="container">

					<div class="swagg-logo-wrapper">
						<img height="100" title="Swagg 2.0" src="{{ getCDN('swagg/assets/img/swagg-logo.png') }}">
					</div>

					<form id="form" class="form" action="{{ path('_authAdmin') }}" method="post" data-js="login={submit:handleForm}">
				        <input type="hidden" name="_token" value="{{ csrf_token('login_token') }}">
						<h1 class="app-name text-uppercase">{{ getEnv('APP_NAME') }}</h1>
						<div class="appname-logo-wrapper">
							<img style="max-width:150px" title="{{ getEnv('APP_NAME') }}" src="{{ getAsset('logo.png?v=') ~ random() }}">
						</div>
						<div id="alert_wrapper">
							{% if userWasNotFound is defined %}
								<p id="not_found" class="_alert _alert-error hidden">Identifiants incorrects</p>
							{% else %}
								{% if app.user is not null %}
								<p id="found" class="_alert _alert-success hidden">Bienvenue <span class="text-uppercase">{{ app.user.username }}</span></p>
								{% endif %}
							{% endif %}
						</div>
						<div id="controls_wrapper">
							<input type="text" name="ident" placeholder="Nom d'Utilisateur ou Email">
							<input type="password" name="password" placeholder="Mot de passe">
							<button type="submit">Connexion</button>
						</div>
						<p class="trademark">
							<a href="{{ getUrl() }}">{{ getEnv('APP_HOST') }}</a><br><br>
							<span>Â© {{ getDateTime().format('Y') }} <span class="app-name"></span></span>
						<p>
					</form>
				</div>
				
				<ul class="bg-bubbles">
					<li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li>
				</ul>
			</div>
		</main>

		<div id="snackbars_wrapper" class="snackbars-wrapper"></div>

		<footer style="position: fixed;bottom: 0;right: 0;margin: 10px 15px;"><b>Swagg</b> v2.0, a CMS by <b>stOne</b></footer>
	</div>
	<script defer src="{{ getCDN('swagg/plugins/backoffice/backoffice.js?v=' ~ random() ) }}"></script>
	<script type="text/javascript">
	$(function(){
		'use strict';
		$('.app-name').text(__.getAppName());
		__.dataJs({
			login: {
				handleForm: function($form){
	                __.ajaxifyForm({
	                    form: $form,
	                    onBound: function ($form) { $form.trigger('submit'); },
	                    ajaxSettings: {
	                        progressBar: false,
	                        onBeforeSend: function () {$('#not_found').addClass('hidden');},
	                        onSuccess: function (r) {
                        		var $virtDOM = $('<div />').html(r.newDom);
                        		$('#alert_wrapper').html( $virtDOM.find('#alert_wrapper').html() );
	                        	if(r.newDom!==undefined){
	                        		var $not_found = $('#not_found');
	                        		if( $not_found.length ){
			                        	$not_found.removeClass('hidden');
	                        		}
	                        		else {
		                        		$('#controls_wrapper').hide();
		                        		$('#found').removeClass('hidden');
		                        		_.delay(function(){
		                        			var redirect_url = __.getUrlVar('redirect_url');
		                        			if( !redirect_url ){
		                        				__.redirect(__.getUrl('_admin/dashboard'));
		                        			}
		                        			else {
		                        				__.redirect(redirect_url);
		                        			}
		                        		}, 3000);
	                        		}
	                        	}
	                        	else if( r.authed !== undefined ){
	                        		var redirect_url = __.getUrlVar('redirect_url');
			                        if( !redirect_url ){
			                        	__.redirect( __.getUrl('_admin/dashboard') );
			                        }
			                        else {
			                        	__.redirect(redirect_url);
			                        }
	                        	}
	                        },
	                        onError: function () { },
	                        onComplete: function(){
	                        }
	                    }
	                });
				}
			}
		})
	});
	</script>
</body>
</html>